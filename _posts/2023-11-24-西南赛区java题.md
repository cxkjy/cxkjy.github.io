---
layout: post
title: 西南赛区java
categories: [blog ]
tags: [Java,]
description: ""
image:
  feature: windows.jpg
  credit: JYcxk
  creditlink: azeril.compu
---



```java
燕子，我终于来了，tnnd早就看上了这道题，然后学kryo复现coffee发现需要RASP，然后学RASP，学完学Hessian，然后才润来🤢
```

1. 提示：Hessian原生JDK利用
2. Kryo反序列化

## 老规矩自己 分析一波

```java
kryo 4.0.2  kryo序列化框架，需要对序列/反序列化的类进行注册，高版本还需有无参构造，默认FieldSerialize序列化方式
snakeyaml-1.26
asm-5.0.4
```

说好的hessian原生JDK，没hessian依赖呀。。。

先看给出的类，实质性就二个类，一个javabean、一个controller

```java
public class MessageController {
    @RequestMapping({"/"})
    @ResponseBody
    public Object message(String message) throws Exception {
        byte[] decodemsg;
        if (message == null) {
            decodemsg = Base64.getDecoder().decode("ASsBAQIDAWnkAQBqYXZhLnV0aWwuVVVJxAHLyYj656nh3Rj89bSK7ufJrcoDAXRpbWVzdGFt8AnMwumxjGIBAWNvbS5zZWEuVXNl8gEBMbABc2VhY2xvdWTz");
        } else {
            try {
                decodemsg = Base64.getDecoder().decode(message);
            } catch (Exception e) {
                decodemsg = Base64.getDecoder().decode("ASsBAQIDAWnkAQBqYXZhLnV0aWwuVVVJxAGBw5uOyvHs1sGsg/nqhOyP9pIDAXRpbWVzdGFt8AnmifmxjGIBAWNvbS5zZWEuVXNl8gEBMbABZXJyb/I=");
            }
        }
        return new CodecMessageConverter(new MessageCodec()).toMessage(decodemsg, null).getPayload();
    }
}
```

给的乱七八糟的，人家不都是直接给反序列化🐎，这里呃呃呃（麻烦的是一个接口套一个接口）

`但不是所有java题都是考链子的！！！`

![image-20231123200706815](X:\github\cxkjy.github.io\cxkjy.github.io\img\final\image-20231123200706815.png)

codec是我们传进去的new MessageCodec()，这里 this.codec.decode(字节码，object类)

![image-20231123201114783](X:\github\cxkjy.github.io\cxkjy.github.io\img\final\image-20231123201114783.png)

![image-20231123201222356](X:\github\cxkjy.github.io\cxkjy.github.io\img\final\image-20231123201222356.png)

然后继续跟进decode中

![image-20231123201248345](X:\github\cxkjy.github.io\cxkjy.github.io\img\final\image-20231123201248345.png)

![image-20231123201255921](X:\github\cxkjy.github.io\cxkjy.github.io\img\final\image-20231123201255921.png)

自己跟进去找到的，应该不是巧合叭，如果是巧合我真的######了

上面其实不用调试，肯定是直接到readobject了，接下来就是找链子了：

斯好tm熟悉啊，这里hashmap无疑了

![image-20231123201601071](X:\github\cxkjy.github.io\cxkjy.github.io\img\final\image-20231123201601071.png)
