---
layout: post
title: misc wireshark题目
categories: [blog ]
tags: [MISC,]
description: "此篇仅记录wireshark题型，并不断更新"
image:
  feature: windows.jpg
  credit: Azeril
  creditlink: azeril.com
 

---

# 前言

```java
由于自己太菜了，而且misc的考点很广泛光加密就有很多，所以目前阶段只能看着wp复现   
```



## 【2023 羊城杯】ai和nia的交响曲

一个wireshark流量包，搜索flag字符串

发现了flag2.zip，然后选中该流，文件->导出http对象

（可以看到基本都是TCP流和HTTP，所以也可以跟随流来分析）

![image-20230903133956077](C:\Users\c'x'k\AppData\Roaming\Typora\typora-user-images\image-20230903133956077.png)

![image-20230903134140377](C:\Users\c'x'k\AppData\Roaming\Typora\typora-user-images\image-20230903134140377.png)

题解说这是一个伪加密

通过搜查资料

```
如遇加密压缩包，在没有密码提示的情况下，先判断是不是伪加密
最简单的方法就是看十六进制数据，第一行如果有09多半就是了
点击查找十六进制数值搜索504B，最后如果有09那基本就是了，改为00完活
对比了一下真实密码压缩的，果然504B后面几乎没有09
```

替换的时候，只需要换`504B后面第一个即`可，`不能全部替换×`

![image-20230903134810615](C:\Users\c'x'k\AppData\Roaming\Typora\typora-user-images\image-20230903134810615.png)

然后获得一个txt里面都是时间

（看wp都是0宽，猜测是因为00:才想的到把）我可以想到的只有肯定有隐写的数据

[Unicode Steganography with Zero-Width Characters (mzy0.com)](https://www.mzy0.com/ctftools/zerowidth1/)

![image-20230903135403303](C:\Users\c'x'k\AppData\Roaming\Typora\typora-user-images\image-20230903135403303.png)

提示先查看flag1,这里在upload.php中发现，（咋发现的，我把全部文件都下载了一个个看的）

![image-20230903135652779](C:\Users\c'x'k\AppData\Roaming\Typora\typora-user-images\image-20230903135652779.png)

这里如果直接把wireshark中拖进010是不行的

需要把右下角换成 英文 raw 中文 原始数据，然后另存为，但是这样数据也会显示其他的，需要手动删除

![image-20230903142052307](C:\Users\c'x'k\AppData\Roaming\Typora\typora-user-images\image-20230903142052307.png)

![image-20230903142228815](C:\Users\c'x'k\AppData\Roaming\Typora\typora-user-images\image-20230903142228815.png)



文件头找这个之前都删除，文件尾部找END，也就是（49454E44)

![image-20230903142252943](C:\Users\c'x'k\AppData\Roaming\Typora\typora-user-images\image-20230903142252943.png)



二进制提取

![image-20230903142413550](C:\Users\c'x'k\AppData\Roaming\Typora\typora-user-images\image-20230903142413550.png)

从图片中提取二进制

```python
from PIL import Image

im = Image.open('1.png')
pix = im.load()
width = im.size[0]
height = im.size[1]
for x in range(width):
    for y in range(height):
        r, g, b = pix[x, y]
        if r>200:
            print(1,end='')
        else:
            print(0,end='')

```

windows用这个库有问题，直接用kali跑了

![image-20230909210024175](C:\Users\c'x'k\AppData\Roaming\Typora\typora-user-images\image-20230909210024175.png)

二进制解码发现提示HINT:BV1wW4y1R7Jv&&FLAG1:@i_n1a_l0v3S_

![image-20230909210046237](C:\Users\c'x'k\AppData\Roaming\Typora\typora-user-images\image-20230909210046237.png)



✌们写的（拿到flag1，hint一眼bv号，https://www.bilibili.com/video/BV1wW4y1R7Jv）

![image-20230909210556534](C:\Users\c'x'k\AppData\Roaming\Typora\typora-user-images\image-20230909210556534.png)

然后根据B站视频一秒一个字符，获得flag (最后有个提示是时间+1是flag)CAOCAOGAIFAN**

`@i_n1a_l0v3S_CAOCAOGAIFAN `

这一道题就折磨我挺多时间的。。。。

### 总结

```
这道题的思路就是全局搜索flag，然后导出http包，如果zip中包含信息图片，需要去头去尾，如果只是单个图片转换为原始数据导出即可，然后09是伪加密在PK后面
```

## EZ_misc

 开局一个图片考虑隐写和套娃，直接010

（里面发现了压缩包直接binwalk）

![image-20230909211858938](C:\Users\c'x'k\AppData\Roaming\Typora\typora-user-images\image-20230909211858938.png)
